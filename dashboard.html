<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Profesor - Shark Learns</title>
    <link rel="stylesheet" href="css/dashboard.css" />
    <link rel="stylesheet" href="css/analytics.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600&display=swap"
      rel="stylesheet"
    />
    <!-- Chart.js para grÃ¡ficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body class="dashboard-body">
    <!-- Header del Dashboard -->
    <header class="dashboard-header">
      <div class="header-content">
        <div class="logo-section">
          <img src="img/shark-logo.png" alt="Shark Logo" class="header-logo" />
          <h1>ğŸ¦ˆ Shark Learns - Dashboard</h1>
        </div>
        <div class="user-section">
          <span class="welcome-text"
            >Bienvenido, <span id="teacher-name">Profesor</span></span
          >
          <button id="logout-btn" class="logout-btn">ğŸšª Cerrar SesiÃ³n</button>
        </div>
      </div>
    </header>

    <!-- NavegaciÃ³n del Dashboard -->
    <nav class="dashboard-nav">
      <div class="nav-content">
        <button class="nav-btn active" data-section="overview">
          ğŸ“Š Resumen
        </button>
        <button class="nav-btn" data-section="students">ğŸ‘¥ Estudiantes</button>
        <button class="nav-btn" data-section="ranking">ğŸ† Ranking</button>
        <button class="nav-btn" data-section="levels">
          â­ Niveles & Logros
        </button>
        <button class="nav-btn" data-section="analytics">ğŸ“ˆ AnalÃ­ticas</button>
      </div>
    </nav>

    <!-- Contenido Principal -->
    <main class="dashboard-main">
      <!-- SecciÃ³n: Resumen -->
      <section id="overview-section" class="dashboard-section active">
        <div class="section-header">
          <h2>ğŸ“Š Resumen General</h2>
          <button id="refresh-overview" class="refresh-btn">
            ğŸ”„ Actualizar
          </button>
        </div>

        <!-- Tarjetas de EstadÃ­sticas -->
        <div class="stats-grid">
          <div class="stat-card" data-aos="fade-up" data-aos-delay="100">
            <div class="stat-icon">ğŸ‘¥</div>
            <div class="stat-content">
              <h3>Total Estudiantes</h3>
              <p class="stat-number" id="total-students">-</p>
            </div>
          </div>
          <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
            <div class="stat-icon">ğŸ®</div>
            <div class="stat-content">
              <h3>Partidas Jugadas</h3>
              <p class="stat-number" id="total-games">-</p>
            </div>
          </div>
          <div class="stat-card" data-aos="fade-up" data-aos-delay="300">
            <div class="stat-icon">ğŸ“Š</div>
            <div class="stat-content">
              <h3>Promedio General</h3>
              <p class="stat-number" id="average-score">-</p>
            </div>
          </div>
          <div class="stat-card" data-aos="fade-up" data-aos-delay="400">
            <div class="stat-icon">âœ…</div>
            <div class="stat-content">
              <h3>PrecisiÃ³n Media</h3>
              <p class="stat-number" id="average-accuracy">-</p>
            </div>
          </div>
        </div>

        <!-- GrÃ¡ficos de Resumen -->
        <div class="charts-grid">
          <div class="chart-container">
            <h3>ğŸ“ˆ Progreso Semanal</h3>
            <div class="chart-wrapper">
              <canvas id="weekly-progress-chart"></canvas>
            </div>
          </div>
          <div class="chart-container">
            <h3>ğŸ¯ DistribuciÃ³n de Puntuaciones</h3>
            <div class="chart-wrapper">
              <canvas id="score-distribution-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <!-- SecciÃ³n: Estudiantes -->
      <section id="students-section" class="dashboard-section">
        <div class="section-header">
          <h2>ğŸ‘¥ GestiÃ³n de Estudiantes</h2>
          <div class="section-controls">
            <div class="search-container">
              <input
                type="text"
                id="student-search"
                placeholder="ğŸ” Buscar estudiante..."
              />
              <div class="search-icon">ğŸ”</div>
            </div>

            <button id="refresh-students" class="refresh-btn">
              ğŸ”„ Actualizar
            </button>
            <button id="export-all-students" class="export-btn">
              ğŸ“Š Exportar Todos
            </button>
          </div>
        </div>

        <!-- EstadÃ­sticas RÃ¡pidas de Estudiantes -->
        <div class="students-overview">
          <div class="overview-card">
            <div class="overview-icon">ğŸ“</div>
            <div class="overview-content">
              <h4>Estudiantes Activos</h4>
              <span id="active-students-count">-</span>
            </div>
          </div>
          <div class="overview-card">
            <div class="overview-icon">â­</div>
            <div class="overview-content">
              <h4>Promedio General</h4>
              <span id="students-avg-score">-</span>
            </div>
          </div>
          <div class="overview-card">
            <div class="overview-icon">ğŸ†</div>
            <div class="overview-content">
              <h4>Mejor Estudiante</h4>
              <span id="top-student-name">-</span>
            </div>
          </div>
          <div class="overview-card">
            <div class="overview-icon">ğŸ“ˆ</div>
            <div class="overview-content">
              <h4>Progreso Total</h4>
              <span id="total-progress">-</span>
            </div>
          </div>
        </div>

        <!-- Lista/Grid de Estudiantes -->
        <div class="students-container">
          <div id="students-list" class="students-grid">
            <!-- Los estudiantes se cargarÃ¡n dinÃ¡micamente -->
          </div>
        </div>

        <!-- Modal de Detalles del Estudiante -->
        <div id="student-modal" class="modal">
          <div class="modal-content student-modal-content">
            <div class="modal-header">
              <div class="student-avatar">ğŸ‘¨â€ğŸ“</div>
              <div class="modal-title-section">
                <h3 id="student-modal-title">Detalles del Estudiante</h3>
                <p id="student-modal-subtitle">EstadÃ­sticas detalladas</p>
              </div>
              <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="student-modal-body">
              <!-- Contenido del modal se carga dinÃ¡micamente -->
            </div>
          </div>
        </div>
      </section>

      <!-- SecciÃ³n: Ranking -->
      <section id="ranking-section" class="dashboard-section">
        <div class="section-header">
          <h2>ğŸ† Ranking de Estudiantes</h2>
          <div class="ranking-controls">
            <div class="period-selector">
              <select id="ranking-period">
                <option value="all">ğŸŒ Todo el tiempo</option>
                <option value="week">ğŸ“… Esta semana</option>
                <option value="month">ğŸ“† Este mes</option>
              </select>
            </div>
            <button id="refresh-ranking" class="refresh-btn">
              ğŸ”„ Actualizar
            </button>
          </div>
        </div>

        <!-- Top 3 Podium Moderno -->
        <div class="podium-modern-container">
          <div class="podium-header">
            <h3>ğŸ–ï¸ TOP 3 ESTUDIANTES</h3>
            <div class="podium-sparkles">âœ¨</div>
          </div>
          <div class="podium-modern">
            <div class="podium-place modern-second">
              <div class="podium-student-modern" id="second-place">
                <div class="place-position">2</div>
                <div class="place-medal">ğŸ¥ˆ</div>
                <div class="student-avatar">ğŸ‘¨â€ğŸ“</div>
                <div class="student-info">
                  <h4>-</h4>
                  <p class="student-score">- pts</p>
                  <div class="achievement-bar">
                    <div class="achievement-fill" style="width: 80%"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="podium-place modern-first">
              <div class="podium-student-modern" id="first-place">
                <div class="place-position">1</div>
                <div class="place-medal">ğŸ¥‡</div>
                <div class="student-avatar">ğŸ‘¨â€ğŸ“</div>
                <div class="student-info">
                  <h4>-</h4>
                  <p class="student-score">- pts</p>
                  <div class="achievement-bar">
                    <div class="achievement-fill" style="width: 100%"></div>
                  </div>
                </div>
                <div class="crown">ğŸ‘‘</div>
              </div>
            </div>
            <div class="podium-place modern-third">
              <div class="podium-student-modern" id="third-place">
                <div class="place-position">3</div>
                <div class="place-medal">ğŸ¥‰</div>
                <div class="student-avatar">ğŸ‘¨â€ğŸ“</div>
                <div class="student-info">
                  <h4>-</h4>
                  <p class="student-score">- pts</p>
                  <div class="achievement-bar">
                    <div class="achievement-fill" style="width: 60%"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Ranking Completo Moderno -->
        <div class="ranking-modern-container">
          <div class="ranking-header">
            <h3>ğŸ“Š Ranking Completo</h3>
            <div class="ranking-filters">
              <button class="filter-btn active" data-filter="all">Todos</button>
              <button class="filter-btn" data-filter="top">Top 10</button>
              <button class="filter-btn" data-filter="recent">Recientes</button>
            </div>
          </div>
          <div class="ranking-list" id="ranking-list">
            <!-- Rankings se cargan dinÃ¡micamente -->
          </div>
        </div>
      </section>

      <!-- SecciÃ³n: Niveles y Logros -->
      <section id="levels-section" class="dashboard-section">
        <div class="section-header">
          <h2>â­ GestiÃ³n de Niveles y Logros</h2>
          <div class="section-controls">
            <button id="refresh-levels" class="refresh-btn">
              ğŸ”„ Actualizar
            </button>
          </div>
        </div>

        <!-- PestaÃ±as de GestiÃ³n -->
        <div class="levels-tabs">
          <button class="tab-btn active" data-tab="levels">ğŸ“Š Niveles</button>
          <button class="tab-btn" data-tab="achievements">ğŸ† Logros</button>
          <button class="tab-btn" data-tab="rewards">ğŸ Premios</button>
        </div>

        <!-- Contenido de Niveles -->
        <div class="tab-content active" id="levels-content">
          <div class="levels-header">
            <h3>ğŸ“Š ConfiguraciÃ³n de Niveles</h3>
            <button class="add-btn" id="add-level-btn">â• Agregar Nivel</button>
          </div>

          <div class="levels-grid" id="levels-grid">
            <!-- Los niveles se cargan dinÃ¡micamente -->
          </div>
        </div>

        <!-- Contenido de Logros -->
        <div class="tab-content" id="achievements-content">
          <div class="achievements-header">
            <h3>ğŸ† GestiÃ³n de Logros</h3>
            <button class="add-btn" id="add-achievement-btn">
              â• Crear Logro
            </button>
          </div>

          <div class="achievements-grid" id="achievements-grid">
            <!-- Los logros se cargan dinÃ¡micamente -->
          </div>
        </div>

        <!-- Contenido de Premios -->
        <div class="tab-content" id="rewards-content">
          <div class="rewards-header">
            <h3>ğŸ Sistema de Premios</h3>
            <button class="add-btn" id="add-reward-btn">â• Crear Premio</button>
          </div>

          <div class="rewards-grid" id="rewards-grid">
            <!-- Los premios se cargan dinÃ¡micamente -->
          </div>
        </div>

        <!-- EstadÃ­sticas de Niveles y Logros -->
        <div class="levels-stats">
          <div class="stat-card">
            <div class="stat-icon">â­</div>
            <div class="stat-content">
              <h4>Total Niveles</h4>
              <span id="total-levels">-</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ†</div>
            <div class="stat-content">
              <h4>Logros Activos</h4>
              <span id="active-achievements">-</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ</div>
            <div class="stat-content">
              <h4>Premios Otorgados</h4>
              <span id="total-rewards">-</span>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ“ˆ</div>
            <div class="stat-content">
              <h4>Promedio Nivel</h4>
              <span id="avg-student-level">-</span>
            </div>
          </div>
        </div>
      </section>

      <!-- SecciÃ³n: AnalÃ­ticas -->
      <section id="analytics-section" class="dashboard-section">
        <div class="section-header">
          <h2>ğŸ“ˆ AnalÃ­ticas Avanzadas</h2>
          <button id="refresh-analytics" class="refresh-btn">
            ğŸ”„ Actualizar
          </button>
        </div>

        <!-- Filtros de AnalÃ­ticas -->
        <div class="analytics-filters">
          <div class="filter-group">
            <label for="analytics-period">PerÃ­odo:</label>
            <select id="analytics-period">
              <option value="week">Ãšltima semana</option>
              <option value="month">Ãšltimo mes</option>
              <option value="quarter">Ãšltimo trimestre</option>
              <option value="all">Todo el tiempo</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="analytics-metric">MÃ©trica:</label>
            <select id="analytics-metric">
              <option value="score">PuntuaciÃ³n</option>
              <option value="accuracy">PrecisiÃ³n</option>
              <option value="time">Tiempo promedio</option>
            </select>
          </div>
        </div>

        <!-- GrÃ¡ficos de AnalÃ­ticas -->
        <div class="analytics-charts">
          <div class="analytics-chart-container">
            <h3>ğŸ“Š Tendencia Temporal</h3>
            <div class="chart-wrapper">
              <canvas id="temporal-trend-chart"></canvas>
            </div>
          </div>
          <div class="analytics-chart-container">
            <h3>ğŸ¯ AnÃ¡lisis de Dificultad</h3>
            <div class="chart-wrapper">
              <canvas id="difficulty-analysis-chart"></canvas>
            </div>
          </div>
        </div>

        <!-- MÃ©tricas Detalladas -->
        <div class="detailed-metrics">
          <div class="metric-box">
            <h4>ğŸ“Š EstadÃ­sticas de Rendimiento</h4>
            <div id="performance-stats">
              <!-- Se carga dinÃ¡micamente -->
            </div>
          </div>
          <div class="metric-box">
            <h4>â±ï¸ AnÃ¡lisis de Tiempo</h4>
            <div id="time-analysis">
              <!-- Se carga dinÃ¡micamente -->
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Modal para Niveles -->
    <div id="level-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="level-modal-title">Crear Nuevo Nivel</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <form id="level-form">
            <input type="hidden" id="level-id" name="level_id">
            
            <div class="form-group">
              <label for="level-number">NÃºmero de Nivel:</label>
              <input type="number" id="level-number" name="level_number" required min="1">
            </div>
            
            <div class="form-group">
              <label for="level-title">TÃ­tulo:</label>
              <input type="text" id="level-title" name="title" required maxlength="100">
            </div>
            
            <div class="form-group">
              <label for="level-description">DescripciÃ³n:</label>
              <textarea id="level-description" name="description" rows="3" maxlength="255"></textarea>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="level-experience">Experiencia Requerida:</label>
                <input type="number" id="level-experience" name="experience_required" required min="0">
              </div>
              
              <div class="form-group">
                <label for="level-points">Puntos de Recompensa:</label>
                <input type="number" id="level-points" name="rewards_points" required min="0">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="level-icon">Icono:</label>
                <input type="text" id="level-icon" name="badge_icon" placeholder="â­" maxlength="10">
              </div>
              
              <div class="form-group">
                <label for="level-color">Color:</label>
                <input type="color" id="level-color" name="badge_color" value="#3498db">
              </div>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn-secondary" onclick="modalManager.hide('level-modal')">Cancelar</button>
              <button type="submit" class="btn-primary">Guardar Nivel</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal para Logros -->
    <div id="achievement-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="achievement-modal-title">Crear Nuevo Logro</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <form id="achievement-form">
            <input type="hidden" id="achievement-id" name="achievement_id">
            
            <div class="form-group">
              <label for="achievement-name">Nombre del Logro:</label>
              <input type="text" id="achievement-name" name="name" required maxlength="100">
            </div>
            
            <div class="form-group">
              <label for="achievement-description">DescripciÃ³n:</label>
              <textarea id="achievement-description" name="description" rows="3" maxlength="255"></textarea>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="achievement-icon">Icono:</label>
                <input type="text" id="achievement-icon" name="icon" placeholder="ğŸ†" maxlength="10">
              </div>
              
              <div class="form-group">
                <label for="achievement-color">Color:</label>
                <input type="color" id="achievement-color" name="badge_color" value="#f39c12">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="achievement-criteria-type">Tipo de Criterio:</label>
                <select id="achievement-criteria-type" name="criteria_type" required>
                  <option value="games_played">Partidas Jugadas</option>
                  <option value="score_reached">PuntuaciÃ³n Alcanzada</option>
                  <option value="streak_days">Racha de DÃ­as</option>
                  <option value="accuracy_percentage">Porcentaje de PrecisiÃ³n</option>
                  <option value="total_points">Puntos Totales</option>
                  <option value="level_reached">Nivel Alcanzado</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="achievement-criteria-value">Valor del Criterio:</label>
                <input type="number" id="achievement-criteria-value" name="criteria_value" required min="1">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="achievement-points">Puntos de Recompensa:</label>
                <input type="number" id="achievement-points" name="points_reward" required min="1">
              </div>
              
              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="achievement-active" name="is_active" checked>
                  <span class="checkmark"></span>
                  Logro Activo
                </label>
              </div>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn-secondary" onclick="modalManager.hide('achievement-modal')">Cancelar</button>
              <button type="submit" class="btn-primary">Guardar Logro</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal para Premios -->
    <div id="reward-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="reward-modal-title">Crear Nuevo Premio</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <form id="reward-form">
            <input type="hidden" id="reward-id" name="reward_id">
            
            <div class="form-group">
              <label for="reward-name">Nombre del Premio:</label>
              <input type="text" id="reward-name" name="name" required maxlength="100">
            </div>
            
            <div class="form-group">
              <label for="reward-description">DescripciÃ³n:</label>
              <textarea id="reward-description" name="description" rows="3" maxlength="255"></textarea>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="reward-type">Tipo de Premio:</label>
                <select id="reward-type" name="reward_type" required>
                  <option value="points">Puntos</option>
                  <option value="badge">Insignia</option>
                  <option value="certificate">Certificado</option>
                  <option value="privilege">Privilegio</option>
                  <option value="physical">FÃ­sico</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="reward-value">Valor del Premio:</label>
                <input type="text" id="reward-value" name="reward_value" required maxlength="100">
              </div>
            </div>
            
            <div class="form-group">
              <label for="reward-points">Puntos Requeridos:</label>
              <input type="number" id="reward-points" name="points_required" required min="1" max="10000">
            </div>
            
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="reward-active" name="is_active" checked>
                <span class="checkmark"></span>
                Premio Activo
              </label>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn-secondary" onclick="modalManager.hide('reward-modal')">Cancelar</button>
              <button type="submit" class="btn-primary">Guardar Premio</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
      <div class="loading-spinner">
        <div class="shark-loading">ğŸ¦ˆ</div>
        <p>Cargando datos...</p>
      </div>
    </div>

    <!-- Scripts -->
    <script src="js/dashboard.js"></script>
  </body>
</html>
